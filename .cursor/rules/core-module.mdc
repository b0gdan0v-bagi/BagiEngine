---
description: Rules for Core module development
globs: src/Modules/Core/**/*
alwaysApply: false
---

# Core Module Guidelines

## Overview
The Core module is the foundation of BagiEngine. It provides essential utilities and base classes.

## Key Components

| Component | When to Use | Reference |
|-----------|-------------|-----------|
| `Singleton<T>` | Global services | `Core/Utils/Singleton.h` |
| `RefCounted` + `IntrusivePtr` | Reference-counted objects | `Core/RefCounted/` |
| `PoolString` | Identifiers, map keys, config keys | `Core/PoolString/` |
| `XmlConfig` / `XmlNode` | Loading XML configuration | `Core/Config/` |
| `PassKey<T>` | Restricted method access | `Core/Utils/PassKey.h` |

## When to Use PoolString
- Configuration keys
- Identifiers compared frequently
- Map/hash keys
- NOT for: temporary strings, user-facing text

## CoreManager

Central hub owning core subsystems. Access via static methods:
- `CoreManager::GetFileSystem()`
- `CoreManager::GetAssertHandlerManager()`
- `CoreManager::GetTestManager()`

**Initialization order** (in `OnApplicationPreInit`):
1. `FileSystem` — needed for loading configs
2. `AssertHandlerManager` — loads config, uses FileSystem
3. `TestManager` — runs tests, uses assert system

## File Organization
- One class per file: `ClassName.h` + `ClassName.cpp`
- Tests: `Core/Tests/TestName.h`

## Checklist for New Code
- [ ] Add to `pch.h` if widely used
- [ ] Update `CMakeLists.txt`
- [ ] Use `ASSERT` macro (not `std::assert`)
- [ ] Add Doxygen comments for public API
- [ ] Add test if appropriate (see tests-module.mdc)
