---
description: Instructions for AI assistant when working with BagiEngine
globs: "**/*"
alwaysApply: true
---

# AI Assistant Instructions

## Language Preferences

- **Code/Documentation/Commits**: English
- **Explanations to user**: Russian (if user writes in Russian)

## When Writing New Code

1. Check existing patterns first — look at similar code in the project
2. Use project utilities — `Singleton`, `PassKey`, `PoolString`, `ASSERT`, etc.
3. Follow module structure — put code in appropriate module
4. Add to `pch.h` if widely used
5. Update `CMakeLists.txt`

## Pattern Selection

| Need | Use | Reference |
|------|-----|-----------|
| Global service | `Singleton<T>` | `BECore/Utils/Singleton.h` |
| UI component | `IWidget` | `BECore/Widgets/` |
| Communication | `EventBase<T>` | `Events/EventBase.h` |
| Config loading | `XmlConfig` / `XmlNode` | `BECore/Config/` |
| Logging | `LOG_INFO()`, `LOG_ERROR()` | `BECore/Logger/Logger.h` |
| Enum definition | `CORE_ENUM(Name, Type, Values)` | `BECore/Utils/EnumUtils.h` |

## Code Preferences

- Use EASTL containers (`eastl::vector`, `eastl::hash_map`) over `std::`
- Use `PoolString` for identifiers and map keys
- Use `IntrusivePtr` instead of raw pointers
- Use `ASSERT` / `EXPECT` macros (not `std::assert`)
- Use `CORE_ENUM` macro instead of `enum class`
- Use underscore prefix for private members: `_isRunning`
- Always add namespace closing comments

## Don't Suggest

- Unnecessary abstractions
- `std::` when EASTL has equivalent
- Raw pointers instead of `IntrusivePtr`
- Global variables instead of `Singleton`
- `enum class` instead of `CORE_ENUM`
- Magic numbers without constants
