cmake_minimum_required(VERSION 3.16)
project(MySDLGame)

set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

include(FetchContent)

FetchContent_Declare(
  SDL3
  GIT_REPOSITORY https://github.com/libsdl-org/SDL.git
  GIT_TAG main
)

set(SDL_SHARED ON CACHE BOOL "" FORCE)
set(SDL_STATIC OFF CACHE BOOL "" FORCE)
set(SDL_TESTS OFF CACHE BOOL "" FORCE)

FetchContent_MakeAvailable(SDL3)

# --- НОВАЯ ЧАСТЬ: Автоматический поиск файлов ---

# Рекурсивно ищем все .cpp и .h файлы в папке src и подпапках
file(GLOB_RECURSE SOURCES "src/*.cpp" "src/*.h" "src/**/*.cpp" "src/**/*.h")

# Создаем исполняемый файл, используя список найденных файлов
add_executable(MyGame ${SOURCES})

# Добавляем папку src в пути поиска заголовочных файлов
# Это позволяет использовать #include <Core/...> вместо #include "Core/..."
target_include_directories(MyGame PRIVATE ${CMAKE_CURRENT_SOURCE_DIR}/src)

# -----------------------------------------------

target_link_libraries(MyGame PRIVATE SDL3-shared)

if(WIN32)
    add_custom_command(TARGET MyGame POST_BUILD
        COMMAND ${CMAKE_COMMAND} -E copy_if_different
        $<TARGET_FILE:SDL3-shared>
        $<TARGET_FILE_DIR:MyGame>
    )
endif()